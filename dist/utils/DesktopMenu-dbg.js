/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/unified/Menu","sap/ui/unified/MenuItem","sap/ui/core/CustomData"],function(e,t,n,i){"use strict";var a=e.extend("sap.ushell.apps.menuPlugin",{metadata:{}});return a.prototype.navigateTo=function(e){var t=sap.ushell.Container.getService("CrossApplicationNavigation");"url"===e.entityType?window.open(e.action):t.toExternal({target:{action:e.action,semanticObject:e.semanticObject}})},a.prototype.handleDesktopMenuItemPress=function(e){var t=e.getParameter("item"),n=t.data("entityType");"submenu"!==n&&(this.menu.close(),this.navigateTo({semanticObject:t.data("semanticObject"),action:t.data("action"),entityType:n}))},a.prototype.createMenu=function(){var e=sap.ushell.Container.getService("SiteService").getMenuHierarchy();this.menu=new t;var a=this,s=function(e,o){var u,r,c,p=o||[];for(u=0;u<p.length;u++)(r=new n({text:p[u].title,isSelectable:"submenu"!==p[u].entityType,select:a.handleDesktopMenuItemPress.bind(a)})).addCustomData(new i({key:"entityType",value:p[u].entityType})),p[u].target&&(r.addCustomData(new i({key:"semanticObject",value:p[u].target.semanticObject})),r.addCustomData(new i({key:"action",value:p[u].target.action}))),e.addItem(r),p[u].entities&&p[u].entities.length>0&&(c=new t,r.setSubmenu(c),s(c,p[u].entities))};s(this.menu,e)},a.prototype.getShellTitle=function(){return sap.ui.getCore().byId("shellTitle")},a.prototype.onAfterRendering=function(){this.menu.$().parent().css({width:this.menu.$().outerWidth(!0),height:this.menu.$().outerHeight(!0)})},a.prototype.init=function(){this.createMenu()},a},!0);